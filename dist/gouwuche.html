<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>购物车</title>
		<link rel="stylesheet" type="text/css" href="font_rivfu8xzozo/iconfont.css"/>
		<link rel="stylesheet" type="text/css" href="css/head.css"/>
		<link rel="stylesheet" type="text/css" href="css/gouwuche.css"/>
		
	</head>
	<body>
		<div class="headtop">
			<div class="headtopm">
				<div class="headtopml" style="width: 330px;float: left;">
					<div>
						欢迎来到酒仙网
						<a href="denglu.html" class="redhover">请登录</a>
						<a href="zhuce.html" class="redhover">免费注册</a>
					</div>
				</div>
				<div class="headtopmr">
					<ul id="headtop">
						<li>我的酒仙&nbsp;|
							<ul>
								<li><a href="#" class="redhover">我的订单</a></li>
								<li><a href="#" class="redhover">物流跟踪</a></li>
								<li><a href="#" class="redhover">我的优惠券</a></li>
							</ul>
						</li>
						<li><a href="#" class="red">CEO邮箱</a>&nbsp;|</li>
						<li><a href="#" class="redhover iconfont icon-dianhua">购物车<span>0</span>件&nbsp;|</a></li>
						
						<li><a href="#" class="red">CLUB会员</a>&nbsp;|</li>
						<li><a href="#" class="redhover">招商入驻&nbsp;|</a></li>
						<li>手机逛酒仙&nbsp;|
							<ul>
								<li>
									<img src="http://misc.jiuxian.com/img/newIndexImg/jxPho-code.jpg"/>
								</li>
							</ul>
						</li>
						
						<li><a href="#" class="redhover iconfont icon-baidu1">网站导航&nbsp;|</a></li>
						<li class="iconfont icon-gerenzhongxin">客户服务&nbsp;|
							<ul>
								<li><a href="#" class="redhover">常见问题</a></li>
								<li><a href="#" class="redhover">配送说明</a></li>
								<li><a href="#" class="redhover">售后服务</a></li>
							</ul>
						</li>
						<li>客服热线<span class="red">400-617-9999</span></li>
					</ul>
				</div>
			</div>
		</div>
		<div class="headimg">
			<a href="#"></a>
		</div>
		<div class="headmain">
			<div class="headmainm">
				<div class="left">
					<a href="#">
						<img alt="酒仙网" src="http://misc.jiuxian.com/img/newIndexImg/logo.png?20160405" width="137" height="65">
					</a>
				
					<a href="#">
						<img src="http://img06.jiuxian.com/bill/2019/0507/7d48c51d53fb4dad98998b375a8236d0.gif" width="110" height="65">
					</a>
				</div>
				<div class="left" style="margin-left: 20px;">
					<div class="headinput">
						<input type="text" placeholder="老酒盛典：年份老酒特价低至29元"/>
						<input type="button" value="搜&nbsp;索"/>
					</div>
					<p>
						<a href="#" class="redhover">茅台</a>&nbsp;|
						<a href="#" class="redhover">五粮液</a>&nbsp;|
						<a href="#" class="redhover">酒鬼</a>&nbsp;|
						
						<a href="#" class="redhover">拉菲</a>&nbsp;|
						<a href="#" class="redhover">郎酒</a>&nbsp;|
						<a href="#" class="redhover">黄尾袋鼠</a>&nbsp;|
						
						<a href="#" class="redhover">水井坊</a>&nbsp;|
						<a href="#" class="redhover">泸州老窖</a>&nbsp;|
						<a href="#" class="redhover">奔富</a>&nbsp;|
						
						<a href="#" class="redhover">董酒</a>
					</p>
				</div>
				<div class="right">
					<img src="http://misc.jiuxian.com/img/newIndexImg/headerProPic1.png"/>
					
				</div>
			</div>
		</div>
		<div class="headnav">
			<div class="headnavm">
				<div class="left white">
					<p>全部分类</p>
					<ul id="shuju">
					</ul>
				</div>
				<ul class="left">
					<li class="left"><a href="index.html" class="white">首页</a></li>
					<li class="left"><a href="#" class="white">领券中心</a></li>
					<li class="left"><a href="#" class="white">酒鬼酒专场</a></li>
					
					<li class="left"><a href="#" class="white">值得买</a></li>
					<li class="left"><a href="#" class="white">葡萄酒馆</a></li>
					<li class="left"><a href="#" class="white">自营甄选</a></li>
					
					<li class="left"><a href="#" class="white">洋酒馆</a></li>
					<li class="left"><a href="#" class="white">新品</a></li>
					<li class="left"><a href="#" class="white">CLUB</a></li>
				</ul>
				<a href="#"  class="right">
					<img src="http://img10.jiuxian.com/bill/2019/0622/c6f9c3396bbe487c85a1a8d6c7fabde3.gif" width="120" height="34">
				</a>
			</div>
		</div>
		<!--以上为头部，-->
		
		<div class="gw">
			<div class="gwtitle">
				<div class="left"><input type="checkbox" id="quanbu" /></div>
				<div class="left"><img src="img/logo.jpg" /></div>
				<div class="left">哈哈哈哈哈哈哈哈哈哈或或或或或或</div>
				<div class="left">单价</div>
				<div class="left">数量</div>
				<div class="left">小计</div>
				<div class="left">操作</div>
			</div>
			<div class="gwshangpin" id="gwshangpin">
				
			</div>
			<div class="gwfoot">
				<div class="left">
					您一共选择了
					<span class="red" id="gwnum">0</span>
					件商品
				</div>
				<div class="left">
					共计
					<span class="red" id="gwzhongjia">0</span>
					元
				</div>
				<div class="right" id="gwduoshou">
					结算
				</div>
			</div>
		</div>
		
		<!--底部-->
		<div class="foot1">
			<div class="foot1m">
				<img src="img/dibu1.jpg" style="margin-left: 120px;" />
			</div>
			
		</div>
		<div class="foot2">
			<div class="foot2m">
				<img src="img/dibu2.jpg" style="margin-left: 120px;" />
			</div>
		</div>
	<script src="js/jquery-1.11.0.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/show.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/id.js" type="text/javascript" charset="utf-8"></script>	
	<script type="text/javascript">
		$(function(){
			var token =  localStorage.getItem("token");
			$.get("http://47.104.244.134:8080/cartlist.do",{
				token:token
			}).done(data=>{
				console.log(data);
				var stre = ""
				for(var i = 0; i<data.length; i++){
					stre +=`
					<div class="gwtitle" data-id="${data[i].id}" data-gid="${data[i].gid}">
						<div class="left"><input type="checkbox" class="gwbox" /></div>
						<div class="left"><img src="${data[i].goods.picurl}" /></div>
						<div class="left">${data[i].goods.name}</div>
						<div class="left"><span>${data[i].goods.price}</span></div>
						<div class="left">
							<input type="submit" value="-" id="gwtet1"/>
							<input type="text" value="${data[i].count}" id="gwtet2"/>
							<input type="submit" value="+" id="gwtet3"/>
						</div>
						<div class="left" id="xiaoji">${data[i].goods.price * data[i].count}</div>
						<div class="left"><span class="redhover">删除</span></div>
					</div>
					`
				}//购物车商品添加
				
				$("#gwshangpin").html(stre);
				$("#quanbu").click(function(){
					$(".gwbox").prop("checked",this.checked)
					$("#gwnum").text($(".gwbox:checked").length)
					var num = 0;
					$(".gwbox:checked").each(function(){
						num += parseInt($(this).parent().siblings().eq(-2).text());
					})
					$("#gwzhongjia").text(num);
				})//点击全选
				$(".gwbox").click(function(){
					if($(".gwbox").length == $(".gwbox:checked").length){
						$("#quanbu").prop("checked",true)
						$("#gwnum").text($(".gwbox:checked").length)
						var num = 0;
						$(".gwbox:checked").each(function(){
							num += parseInt($(this).parent().siblings().eq(-2).text());
						})
						$("#gwzhongjia").text(num);
					}else{
						$("#quanbu").prop("checked",false)
						$("#gwnum").text($(".gwbox:checked").length)
						var num = 0;//点击总价显示
						$(".gwbox:checked").each(function(){
							num += parseInt($(this).parent().siblings().eq(-2).text());
						})
						$("#gwzhongjia").text(num);
					}
				})//取消某一个，全部按钮取消
				$("#gwshangpin .gwtitle").each(function(){
					$(this).find("div:last-child").click(function(){
						$.get("http://47.104.244.134:8080/cartupdate.do",{
							id:$(this).parents().attr("data-id"),
							gid:$(this).parents().attr("data-gid"),
							num:0,
							token:token
						}).done(data=>{
							console.log(data)
							if(data.code == 0){
								$(this).parent().remove()
								
							}else{
								alert("删除失败")
							}
						})
					})
				})//全部删除
				
				$("#gwshangpin .gwtitle").each(function(){
					//console.log($(this).find("div:nth-child(5) input:nth-child(3)"))
					$(this).find("div:nth-child(5) input:nth-child(3)").click(function(){
						$.get("http://47.104.244.134:8080/cartupdate.do",{
							id:$(this).parents().parents().attr("data-id"),
							gid:$(this).parents().parents().attr("data-gid"),
							num:1,
							token:token
						}).done(data=>{
							console.log(data)
							
						})
					})
				})//加号
				if(parseInt($("#gwtet2").val()) > 1){
					$("#gwshangpin .gwtitle").each(function(){
						//console.log($(this).find("div:nth-child(5) input:nth-child(3)"))
						$(this).find("div:nth-child(5) input:nth-child(1)").click(function(){
							$.get("http://47.104.244.134:8080/cartupdate.do",{
								id:$(this).parents().parents().attr("data-id"),
								gid:$(this).parents().parents().attr("data-gid"),
								num:-1,
								token:token
							}).done(data=>{
								console.log(data)
								
							})
						})
					})//减号
				}
				
				
				
				
				
			})
		})
	</script>
	</body>
</html>
